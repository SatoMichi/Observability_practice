# Observabilityç ”ä¿® - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œåˆ†ææ¼”ç¿’ï¼ˆä¸€å•ä¸€ç­”å½¢å¼ï¼‰

## ğŸ¯ å°å…¥ï¼šã“ã®æ¼”ç¿’ã®ç›®çš„

ã“ã®æ¼”ç¿’ã§ã¯ã€å®Ÿéš›ã®ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç’°å¢ƒã§ç™ºç”Ÿã™ã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã‚’ã€OpenTelemetryã¨Datadogã‚’ä½¿ã£ã¦åˆ†æãƒ»è§£æ±ºã™ã‚‹å®Ÿè·µçš„ã‚¹ã‚­ãƒ«ã‚’èº«ã«ä»˜ã‘ã¾ã™ã€‚

**å­¦ç¿’ç›®æ¨™:**
1. **å®Ÿç’°å¢ƒObservabilityæŠ€è¡“**: ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®è©³ç´°åˆ†æ
2. **æ¢åµçš„èª¿æŸ»ã‚¹ã‚­ãƒ«**: éš ã•ã‚ŒãŸå•é¡Œã‚„æ©Ÿèƒ½ã®ç™ºè¦‹
3. **å®šé‡çš„æ”¹å–„è¨ˆç”»**: æ•°å€¤ã«åŸºã¥ãå„ªå…ˆé †ä½ä»˜ã‘
4. **å®Ÿå‹™çš„å•é¡Œè§£æ±º**: æ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹åŠ¹æœçš„æ”¹å–„

**é‡è¦**: ã“ã®ç ”ä¿®ã§ã¯æ„å›³çš„ã«UIãŒåˆ¶é™ã•ã‚Œã¦ãŠã‚Šã€ç ”ä¿®ç”Ÿã®æ¢ç´¢ãƒ»ç™ºè¦‹ã‚¹ã‚­ãƒ«ã‚’è©¦ã™ãƒˆãƒ©ãƒƒãƒ—ãŒä»•è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚

---

## ğŸ•µï¸ èª²é¡Œ1: éš ã•ã‚ŒãŸæ©Ÿèƒ½ç™ºè¦‹ãƒãƒ£ãƒ¬ãƒ³ã‚¸

### èª²é¡Œ
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ä½¿ã£ã¦æ¤œç´¢ã™ã‚‹ã¨ã€é¸æŠè‚¢ãŒã€ŒTF-IDFï¼ˆé…ã„ç‰ˆãƒ»ç ”ä¿®ç”¨ï¼‰ã€ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®èµ·å‹•ãƒ­ã‚°ã‚’è¦‹ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒã‚ã‚Šã¾ã™ï¼š

```
INFO: BM25ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ§‹ç¯‰ä¸­...
INFO: BM25ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ§‹ç¯‰å®Œäº†: 18æ–‡æ›¸ã€å‡¦ç†æ™‚é–“ 0.09ç§’
```

**ğŸ¤” è³ªå•**: ãªãœBM25ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒä½œã‚‰ã‚Œã¦ã„ã‚‹ã®ã«ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§é¸æŠã§ããªã„ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### è§£æ±ºç­–

**ğŸ” èª¿æŸ»ãƒ—ãƒ­ã‚»ã‚¹:**
1. **UIã¨APIã®åˆ†é›¢ç†è§£**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®é¸æŠè‚¢ â‰  ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®æ©Ÿèƒ½
2. **ãƒˆãƒ¬ãƒ¼ã‚¹èª¿æŸ»**: èµ·å‹•æ™‚ã®Spanã§BM25ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ§‹ç¯‰ã‚’ç¢ºèª
3. **APIæ¢ç´¢**: ç›´æ¥APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆ

**ğŸ’¡ ç™ºè¦‹:**
```bash
# éš ã•ã‚ŒãŸé«˜é€Ÿæ¤œç´¢ãŒä½¿ç”¨å¯èƒ½
curl "http://api/search?q=love&method=tfidf"   # 414msï¼ˆé«˜é€Ÿç‰ˆï¼‰
curl "http://api/search?q=love&method=bm25"    # 525msï¼ˆé«˜ç²¾åº¦ç‰ˆï¼‰
curl "http://api/search?q=love&method=slow_tfidf"  # 4260msï¼ˆç ”ä¿®ç”¨ï¼‰
```

**ğŸ¯ å­¦ç¿’åŠ¹æœ:**
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åˆ†é›¢ã®ç†è§£
- Observabilityãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ãŸæ©Ÿèƒ½æ¢ç´¢
- éš ã•ã‚ŒãŸæ©Ÿèƒ½ã®ç™ºè¦‹æŠ€è¡“

---

## ğŸŒ èª²é¡Œ2: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç•°å¸¸æ„ŸçŸ¥ãƒãƒ£ãƒ¬ãƒ³ã‚¸

### èª²é¡Œ
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§æ¤œç´¢ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ç´„4ç§’ã‹ã‹ã‚Šã¾ã™ã€‚

**ğŸ¤” è³ªå•**: ç¾ä»£ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§4ç§’ã®å¿œç­”æ™‚é–“ã¯é©åˆ‡ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### è§£æ±ºç­–

**ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŸºæº–:**
- **å„ªç§€**: 100msä»¥ä¸‹
- **è‰¯å¥½**: 100-500ms
- **è¨±å®¹**: 500ms-1ç§’
- **å•é¡Œ**: 1ç§’ä»¥ä¸Š
- **æ·±åˆ»**: **4ç§’ï¼ˆç¾çŠ¶ï¼‰**

**ğŸ” æ¯”è¼ƒèª¿æŸ»çµæœ:**
```
Googleæ¤œç´¢: 200-300ms
Amazonå•†å“æ¤œç´¢: 400-600ms
GitHub ãƒªãƒã‚¸ãƒˆãƒªæ¤œç´¢: 300-500ms
æœ¬ã‚·ã‚¹ãƒ†ãƒ ï¼ˆé…ã„ç‰ˆï¼‰: 4260ms â† ğŸ”´ ç•°å¸¸
æœ¬ã‚·ã‚¹ãƒ†ãƒ ï¼ˆé«˜é€Ÿç‰ˆï¼‰: 414ms â† âœ… æ­£å¸¸
```

**ğŸ’¡ ç™ºè¦‹:**
éš ã•ã‚ŒãŸé«˜é€Ÿç‰ˆTF-IDFãŒå­˜åœ¨ã—ã€ãã‚Œã¯414msã§æ­£å¸¸ãªæ€§èƒ½ã‚’ç¤ºã—ã¾ã™ã€‚

**ğŸ¯ å­¦ç¿’åŠ¹æœ:**
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ„Ÿè¦šã®é¤Šæˆ
- ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ»æ¯”è¼ƒåˆ†æã®é‡è¦æ€§
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã¨æŠ€è¡“æ€§èƒ½ã®é–¢ä¿‚ç†è§£

---

## âš¡ èª²é¡Œ3: å‰å‡¦ç†ãƒœãƒˆãƒ«ãƒãƒƒã‚¯åˆ†æ

### èª²é¡Œ
Datadogãƒˆãƒ¬ãƒ¼ã‚¹ã§ä»¥ä¸‹ã®SpanãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸï¼š

```json
{
  "span_name": "slow_preprocess_query",
  "duration": 210.0,
  "attributes": {
    "query.original": "love",
    "query.processed": "love", 
    "bottleneck.dummy_operations": 500000
  }
}
```

**ğŸ¤” è³ªå•**: ã€Œloveã€ã¨ã„ã†4æ–‡å­—ã®ã‚¯ã‚¨ãƒªã®å‰å‡¦ç†ã«210msã‚‚ã‹ã‹ã‚‹ç†ç”±ã¯ä½•ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### è§£æ±ºç­–

**ğŸ” æ ¹æœ¬åŸå› åˆ†æ:**
```python
# ğŸ”´ å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰
def slow_preprocess_query(query):
    processed_query = preprocess_text(query)  # æ­£å¸¸å‡¦ç†: 1ms
    
    # å•é¡Œ1: ç„¡é§„ãªãƒ«ãƒ¼ãƒ—å‡¦ç†
    for i in range(50000):  # 50,000å›ã®ä¸è¦ãªå‡¦ç†
        temp_string = processed_query.upper().lower().strip()
    
    # å•é¡Œ2: ä¸è¦ãªå¾…æ©Ÿæ™‚é–“
    time.sleep(0.2)  # 200msã®äººç‚ºçš„é…å»¶
    
    return processed_query
```

**ğŸ’¡ æ”¹å–„ç­–:**
```python
# âœ… æ”¹å–„å¾Œã®ã‚³ãƒ¼ãƒ‰
def optimized_preprocess_query(query):
    return preprocess_text(query)  # ä¸è¦ãªå‡¦ç†ã‚’å‰Šé™¤
```

**ğŸ“Š æ”¹å–„åŠ¹æœ:**
- **æ”¹å–„å‰**: 210ms
- **æ”¹å–„å¾Œ**: 1ms
- **çŸ­ç¸®ç‡**: **99.5%**

**ğŸ¯ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:**
- ã‚«ã‚¹ã‚¿ãƒ å±æ€§ï¼ˆ`bottleneck.dummy_operations`ï¼‰ã®æ´»ç”¨
- ç„¡é§„ãªå‡¦ç†ã®ç‰¹å®šæŠ€è¡“
- å‡¦ç†æ™‚é–“ã¨å®Ÿéš›ã®ä½œæ¥­é‡ã®é–¢ä¿‚åˆ†æ

---

## ğŸ”„ èª²é¡Œ4: ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã®é‡è¤‡å‡¦ç†å•é¡Œ

### èª²é¡Œ
ä»¥ä¸‹ã®Spanãƒ‡ãƒ¼ã‚¿ãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸï¼š

```json
{
  "span_name": "slow_vectorize_query", 
  "duration": 512.0,
  "attributes": {
    "vector.shape": "(1, 5000)",
    "bottleneck.duplicate_vectorizations": 10
  }
}
```

**ğŸ¤” è³ªå•**: åŒã˜ã‚¯ã‚¨ãƒªã®ãƒ™ã‚¯ãƒˆãƒ«åŒ–ãŒãªãœ10å›ã‚‚å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### è§£æ±ºç­–

**ğŸ” é‡è¤‡å‡¦ç†ã®ç‰¹å®š:**
```python
# ğŸ”´ å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰
def slow_vectorize_query(processed_query):
    # æ­£å¸¸ãªãƒ™ã‚¯ãƒˆãƒ«åŒ–ï¼ˆ1å›ç›®ï¼‰
    query_vector = tfidf_vectorizer.transform([processed_query])  # 50ms
    
    # å•é¡Œ: åŒã˜å‡¦ç†ã‚’9å›é‡è¤‡å®Ÿè¡Œ
    for i in range(10):
        duplicate_vector = tfidf_vectorizer.transform([processed_query])
        time.sleep(0.05)  # å„å›50msé…å»¶
    
    return query_vector
```

**ğŸ’¡ æ”¹å–„ç­–:**
```python
# âœ… æ”¹å–„å¾Œã®ã‚³ãƒ¼ãƒ‰
def optimized_vectorize_query(processed_query):
    # 1å›ã ã‘å®Ÿè¡Œ
    return tfidf_vectorizer.transform([processed_query])
```

**ğŸ“Š æ”¹å–„åŠ¹æœ:**
- **æ”¹å–„å‰**: 512ms
- **æ”¹å–„å¾Œ**: 50ms
- **çŸ­ç¸®ç‡**: **90.2%**

**ğŸ¯ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:**
- é‡è¤‡å‡¦ç†ã®æ¤œå‡ºæŠ€è¡“
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡æ€§ã®è€ƒæ…®
- ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã®é‡è¦æ€§

---

## ğŸ§® èª²é¡Œ5: é¡ä¼¼åº¦è¨ˆç®—ã®ç„¡é§„ãªå†å®Ÿè¡Œ

### èª²é¡Œ
ä»¥ä¸‹ã®é¡ä¼¼åº¦è¨ˆç®—SpanãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸï¼š

```json
{
  "span_name": "slow_compute_similarity",
  "duration": 510.0, 
  "attributes": {
    "similarity.matrix_size": 18,
    "bottleneck.recalculation_operations": 90
  }
}
```

**ğŸ¤” è³ªå•**: 18æ–‡æ›¸ã¨ã®é¡ä¼¼åº¦è¨ˆç®—ã«510msã‹ã‹ã‚Šã€90å›ã®å†è¨ˆç®—ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ç†ç”±ã¯ï¼Ÿ

### è§£æ±ºç­–

**ğŸ” å†è¨ˆç®—å•é¡Œã®åˆ†æ:**
```python
# ğŸ”´ å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰
def slow_compute_similarity(query_vector, tfidf_matrix):
    # æ­£å¸¸ãªé¡ä¼¼åº¦è¨ˆç®—ï¼ˆ1å›ç›®ï¼‰
    similarities = cosine_similarity(query_vector, tfidf_matrix)  # 30ms
    
    # å•é¡Œ: åŒã˜è¨ˆç®—ã‚’5å›ç¹°ã‚Šè¿”ã—
    for i in range(5):
        temp_similarities = cosine_similarity(query_vector, tfidf_matrix)
        time.sleep(0.1)  # å„å›100msé…å»¶
    
    return similarities
```

**ğŸ’¡ æ”¹å–„ç­–:**
```python
# âœ… æ”¹å–„å¾Œã®ã‚³ãƒ¼ãƒ‰
def optimized_compute_similarity(query_vector, tfidf_matrix):
    # 1å›ã ã‘è¨ˆç®—
    return cosine_similarity(query_vector, tfidf_matrix)
```

**ğŸ“Š æ”¹å–„åŠ¹æœ:**
- **æ”¹å–„å‰**: 510ms
- **æ”¹å–„å¾Œ**: 30ms
- **çŸ­ç¸®ç‡**: **94.1%**

**ğŸ¯ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:**
- è¨ˆç®—é‡ã®æœ€é©åŒ–
- çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥
- ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ åŠ¹ç‡æ€§ã®è©•ä¾¡

---

## ğŸ“ èª²é¡Œ6: ã‚¹ãƒ‹ãƒšãƒƒãƒˆç”Ÿæˆã®æ·±åˆ»ãªæ€§èƒ½åŠ£åŒ–

### èª²é¡Œ
æœ¬ç•ªç’°å¢ƒã®Datadog UIã§ä»¥ä¸‹ã®æ·±åˆ»ãªãƒœãƒˆãƒ«ãƒãƒƒã‚¯ãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸï¼š

```
slow_process_results: 3.02s (å…¨ä½“ã®71%)
â”œâ”€â”€ slow_generate_snippet #1: 355ms
â”œâ”€â”€ slow_generate_snippet #2: 1.38s â† ğŸ”´ ç•°å¸¸å€¤
â”œâ”€â”€ slow_generate_snippet #3: 203ms
â”œâ”€â”€ slow_generate_snippet #4: 121ms
â”œâ”€â”€ slow_generate_snippet #5: 180ms
â”œâ”€â”€ slow_generate_snippet #6: 405ms
â”œâ”€â”€ slow_generate_snippet #7: 87ms
â”œâ”€â”€ slow_generate_snippet #8: 126ms
â”œâ”€â”€ slow_generate_snippet #9: 37ms
â”œâ”€â”€ slow_generate_snippet #10: 80.5ms
```

**ğŸ¤” è³ªå•**: ãªãœã‚¹ãƒ‹ãƒšãƒƒãƒˆç”Ÿæˆã§37msã€œ1380msã®å·¨å¤§ãªå¤‰å‹•ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### è§£æ±ºç­–

**ğŸ” å¤‰å‹•åŸå› åˆ†æ:**
- **å¹³å‡æ™‚é–“**: 297msï¼ˆæ­£å¸¸å€¤30msã®ç´„10å€ï¼‰
- **æœ€å¤§å¤‰å‹•**: 37å€ã®å·®ï¼ˆ37msã€œ1380msï¼‰
- **åˆè¨ˆå½±éŸ¿**: 2.97ç§’ï¼ˆå…¨ä½“ã®70%ï¼‰

**ğŸ’¡ æ¨å®šåŸå› ã¨æ”¹å–„ç­–:**
```python
# ğŸ”´ å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆæ¨å®šï¼‰
def slow_generate_snippet(text, query):
    time.sleep(0.03)  # åŸºæœ¬é…å»¶
    
    # å•é¡Œ1: æ–‡æ›¸ã‚µã‚¤ã‚ºä¾å­˜ã®éç·šå½¢åŠ£åŒ–
    if len(text) > 100000:
        time.sleep(0.1 * len(text) / 100000)  # å¤§æ–‡æ›¸ã§æŒ‡æ•°çš„åŠ£åŒ–
    
    # å•é¡Œ2: ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å½±éŸ¿
    # å•é¡Œ3: I/Oå¾…æ©Ÿ
    # å•é¡Œ4: ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯
    
    return get_snippet(text, query)

# âœ… æ”¹å–„ç­–1: åŸºæœ¬æœ€é©åŒ–
def optimized_generate_snippet(text, query):
    # sleepå‰Šé™¤ã€åŠ¹ç‡çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ä½¿ç”¨
    return get_snippet_efficiently(text, query)

# ğŸš€ æ”¹å–„ç­–2: ä¸¦åˆ—å‡¦ç†
import asyncio
async def parallel_snippet_generation(books, query):
    tasks = [generate_snippet_async(book, query) for book in books]
    return await asyncio.gather(*tasks)
```

**ğŸ“Š æ”¹å–„åŠ¹æœ:**
- **æ”¹å–„å‰**: 2974ms
- **æ”¹å–„å¾Œ**: 250msï¼ˆä¸¦åˆ—åŒ–ï¼‰
- **çŸ­ç¸®ç‡**: **91.6%**

**ğŸ¯ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:**
- æœ¬ç•ªç’°å¢ƒç‰¹æœ‰ã®å•é¡Œï¼ˆé–‹ç™ºç’°å¢ƒã§ã¯å†ç¾å›°é›£ï¼‰
- å‡¦ç†æ™‚é–“ã®ä¸å®‰å®šæ€§åˆ†æ
- ä¸¦åˆ—å‡¦ç†ã«ã‚ˆã‚‹åŠ‡çš„æ”¹å–„åŠ¹æœ

---

## ğŸ”„ èª²é¡Œ7: ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®éåŠ¹ç‡æ€§

### èª²é¡Œ
ä»¥ä¸‹ã®ã‚½ãƒ¼ãƒˆå‡¦ç†ãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸï¼š

```json
{
  "span_name": "inefficient_bubble_sort",
  "duration": 48.4,
  "attributes": {
    "bottleneck.bubble_sort_comparisons": 45
  }
}
```

**ğŸ¤” è³ªå•**: 10è¦ç´ ã®ã‚½ãƒ¼ãƒˆã«48msã‹ã‹ã‚‹ã®ã¯é©åˆ‡ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### è§£æ±ºç­–

**ğŸ” ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ åˆ†æ:**
```python
# ğŸ”´ å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆãƒãƒ–ãƒ«ã‚½ãƒ¼ãƒˆ O(nÂ²)ï¼‰
def inefficient_bubble_sort(results):
    n = len(results)
    for i in range(min(n, 50)):
        for j in range(min(n-i-1, 50)):
            if results[j]['score'] < results[j+1]['score']:
                results[j], results[j+1] = results[j+1], results[j]
            time.sleep(0.001)  # 1msé…å»¶
    return results

# âœ… æ”¹å–„å¾Œã®ã‚³ãƒ¼ãƒ‰ï¼ˆPythonã®çµ„ã¿è¾¼ã¿ã‚½ãƒ¼ãƒˆ O(n log n)ï¼‰
def optimized_sort(results):
    return sorted(results, key=lambda x: x['score'], reverse=True)
```

**ğŸ“Š æ€§èƒ½æ¯”è¼ƒ:**
- **ãƒãƒ–ãƒ«ã‚½ãƒ¼ãƒˆ**: 48.4msï¼ˆO(nÂ²) + äººç‚ºçš„é…å»¶ï¼‰
- **çµ„ã¿è¾¼ã¿ã‚½ãƒ¼ãƒˆ**: 0.1msï¼ˆO(n log n)ï¼‰
- **çŸ­ç¸®ç‡**: **99.8%**

**ğŸ¯ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:**
- ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠã®é‡è¦æ€§
- æ™‚é–“è¨ˆç®—é‡ã®å®Ÿéš›çš„å½±éŸ¿
- æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ´»ç”¨

---

## ğŸŒ èª²é¡Œ8: æœ¬ç•ªç’°å¢ƒã§ã®æ€§èƒ½åŠ£åŒ–å•é¡Œ

### èª²é¡Œ
é–‹ç™ºç’°å¢ƒã§ã®äºˆæƒ³æ€§èƒ½ã¨æœ¬ç•ªç’°å¢ƒã§ã®å®Ÿæ¸¬å€¤ã«å¤§ããªå·®ãŒå‡ºã¾ã—ãŸï¼š

- **é–‹ç™ºç’°å¢ƒäºˆæƒ³**: 2.166ç§’
- **æœ¬ç•ªç’°å¢ƒå®Ÿæ¸¬**: **4.26ç§’**ï¼ˆç´„2å€åŠ£åŒ–ï¼‰

**ğŸ¤” è³ªå•**: ãªãœæœ¬ç•ªç’°å¢ƒã§ã“ã‚Œã»ã©æ€§èƒ½ãŒåŠ£åŒ–ã—ãŸã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### è§£æ±ºç­–

**ğŸ” ç’°å¢ƒå·®ç•°åˆ†æ:**

| è¦å›  | é–‹ç™ºç’°å¢ƒ | æœ¬ç•ªç’°å¢ƒ | å½±éŸ¿ |
|------|----------|----------|------|
| **ãƒªã‚½ãƒ¼ã‚¹ç«¶åˆ** | å°‚ç”¨ãƒªã‚½ãƒ¼ã‚¹ | å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹ | **+30%** |
| **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é…å»¶** | ãƒ­ãƒ¼ã‚«ãƒ« | ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”± | **+20%** |
| **ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³** | è»½è² è· | é«˜è² è·ã§GCé »ç™º | **+25%** |
| **I/Oå¾…æ©Ÿ** | SSDé«˜é€Ÿ | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | **+15%** |

**ğŸ’¡ æœ¬ç•ªç’°å¢ƒå¯¾å¿œç­–:**
```python
# ğŸ”§ æœ¬ç•ªç’°å¢ƒæœ€é©åŒ–
def production_optimized_search():
    # 1. éåŒæœŸå‡¦ç†ã§I/Oå¾…æ©Ÿå‰Šæ¸›
    # 2. ãƒ¡ãƒ¢ãƒªãƒ—ãƒ¼ãƒ«ä½¿ç”¨ã§GCå‰Šæ¸›
    # 3. çµæœã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã§é‡è¤‡è¨ˆç®—å›é¿
    # 4. æ®µéšçš„ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°
    pass
```

**ğŸ“Š ç·åˆæ”¹å–„åŠ¹æœï¼ˆæœ¬ç•ªç’°å¢ƒãƒ™ãƒ¼ã‚¹ï¼‰:**
- **æ”¹å–„å‰**: 4.26ç§’
- **æ”¹å–„å¾Œ**: 0.34ç§’
- **çŸ­ç¸®ç‡**: **92.0%**

**ğŸ¯ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:**
- é–‹ç™ºç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã®é•ã„ç†è§£
- å®Ÿæ¸¬å€¤ã®é‡è¦æ€§
- ç’°å¢ƒå›ºæœ‰ã®æœ€é©åŒ–æ‰‹æ³•

---

## ğŸ† ã¾ã¨ã‚ï¼šç·åˆçš„ãªå­¦ç¿’æˆæœ

### ğŸ“Š æœ€çµ‚çš„ãªæ”¹å–„åŠ¹æœ

| å‡¦ç†æ®µéš | æ”¹å–„å‰æ™‚é–“ | æ”¹å–„å¾Œæ™‚é–“ | çŸ­ç¸®ç‡ | æ”¹å–„æ‰‹æ³• |
|---------|-----------|-----------|--------|---------|
| **å‰å‡¦ç†** | 210ms | 5ms | **97.6%** | ç„¡é§„å‡¦ç†å‰Šé™¤ |
| **ãƒ™ã‚¯ãƒˆãƒ«åŒ–** | 512ms | 50ms | **90.2%** | é‡è¤‡å‡¦ç†é™¤å» |
| **é¡ä¼¼åº¦è¨ˆç®—** | 510ms | 30ms | **94.1%** | å†è¨ˆç®—é™¤å» |
| **ã‚¹ãƒ‹ãƒšãƒƒãƒˆç”Ÿæˆ** | 2974ms | 250ms | **91.6%** | ä¸¦åˆ—åŒ–+æœ€é©åŒ– |
| **ã‚½ãƒ¼ãƒˆ** | 48ms | 1ms | **97.9%** | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¤‰æ›´ |
| **ç·åˆ** | **4.26ç§’** | **0.34ç§’** | **92.0%** | **åŒ…æ‹¬çš„æœ€é©åŒ–** |

### ğŸ¯ ç¿’å¾—ã§ããŸå®Ÿè·µã‚¹ã‚­ãƒ«

1. **ğŸ•µï¸ æ¢åµçš„èª¿æŸ»æŠ€è¡“**:
   - éš ã•ã‚ŒãŸæ©Ÿèƒ½ã®ç™ºè¦‹ï¼ˆBM25, é«˜é€ŸTF-IDFï¼‰
   - UIåˆ¶é™ã‚’çªç ´ã™ã‚‹APIæ¢ç´¢
   - ãƒˆãƒ¬ãƒ¼ã‚¹ã‹ã‚‰ã®ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ æ¨å®š

2. **ğŸ“Š å®šé‡çš„åˆ†æã‚¹ã‚­ãƒ«**:
   - Waterfall Chartã«ã‚ˆã‚‹è¦–è¦šçš„ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š
   - å‡¦ç†æ™‚é–“å¤‰å‹•ã®çµ±è¨ˆåˆ†æï¼ˆ37msã€œ1380msï¼‰
   - æ”¹å–„åŠ¹æœã®æ­£ç¢ºãªè©¦ç®—ï¼ˆ92%çŸ­ç¸®ï¼‰

3. **ğŸ”§ å®Ÿå‹™çš„æ”¹å–„æŠ€è¡“**:
   - æ®µéšçš„æ”¹å–„è¨ˆç”»ï¼ˆãƒ•ã‚§ãƒ¼ã‚º1ã€œ3ï¼‰
   - ä¸¦åˆ—å‡¦ç†ã«ã‚ˆã‚‹åŠ‡çš„æ€§èƒ½å‘ä¸Š
   - æœ¬ç•ªç’°å¢ƒç‰¹æœ‰ã®å•é¡Œå¯¾å¿œ

4. **ğŸ“ Observabilityãƒã‚¹ã‚¿ãƒªãƒ¼**:
   - 19å€‹ã®Spanã®éšå±¤æ§‹é€ ç†è§£
   - ã‚«ã‚¹ã‚¿ãƒ å±æ€§ã«ã‚ˆã‚‹è©³ç´°èª¿æŸ»
   - å®Ÿç’°å¢ƒã§ã®ãƒˆãƒ¬ãƒ¼ã‚¹åˆ†æå®Ÿè·µ

### ğŸš€ å®Ÿå‹™ã¸ã®å¿œç”¨

**å³æˆ¦åŠ›ã‚¹ã‚­ãƒ«:**
- ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œå³åº§ç‰¹å®š
- ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªæ”¹å–„å„ªå…ˆé †ä½ä»˜ã‘
- ãƒãƒ¼ãƒ é–“ã§ã®æŠ€è¡“çš„èª¬æ˜ãƒ»èª¬å¾—åŠ›

**ç¶™ç¶šçš„æˆé•·:**
- æ–°ã—ã„Observabilityãƒ„ãƒ¼ãƒ«ã¸ã®é©å¿œåŠ›
- è¤‡é›‘ãªãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ç’°å¢ƒã§ã®èª¿æŸ»èƒ½åŠ›
- æ¬¡ä¸–ä»£ç›£è¦–æŠ€è¡“ã®ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—

### ğŸŒŸ ç ”ä¿®è¨­è¨ˆã®æ•™è‚²åŠ¹æœ

ã“ã®ç ”ä¿®ã®å·§å¦™ãªè¨­è¨ˆã«ã‚ˆã‚Šï¼š

1. **è‡ªç„¶ãªç–‘å•å½¢æˆ**: ã€Œãªãœé¸æŠè‚¢ãŒ1ã¤ï¼Ÿã€ã€Œãªãœ4ç§’ã‚‚ï¼Ÿã€
2. **èƒ½å‹•çš„æ¢ç´¢**: è‡ªåˆ†ã§APIã‚’è©¦ã—ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’èª¿æŸ»
3. **ç™ºè¦‹ã®å–œã³**: éš ã•ã‚ŒãŸé«˜é€Ÿæ©Ÿèƒ½ã‚’è¦‹ã¤ã‘ã‚‹é”æˆæ„Ÿ
4. **å®Ÿè·µçš„ã‚¹ã‚­ãƒ«**: å˜ãªã‚‹çŸ¥è­˜ã§ãªãã€å®Ÿéš›ã«ä½¿ãˆã‚‹æŠ€è¡“

**çµè«–**: ç†è«–ã¨å®Ÿè·µã‚’çµ±åˆã—ã€æ¢åµçš„èª¿æŸ»ã‚¹ã‚­ãƒ«ã¾ã§é¤Šæˆã™ã‚‹**å®Œç’§ãªObservabilityç ”ä¿®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **ã¨ã—ã¦ã€å®Ÿå‹™å³æˆ¦åŠ›ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚’è‚²æˆã§ãã¾ã™ã€‚
